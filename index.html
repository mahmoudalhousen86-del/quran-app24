<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØµØ­Ù Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a472a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ù…ØµØ­Ù Ø§Ù„Ù‚Ø±Ø¢Ù†">
    <meta name="description" content="Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… ÙƒØ§Ù…Ù„Ø§Ù‹ Ù…Ø¹ Ø§Ù„ØªÙØ³ÙŠØ± ÙˆØ§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª - ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" href="https://img.icons8.com/color/96/000000/quran.png">
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/192/000000/quran.png">
    
    <!-- CSS Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri+Quran&family=Noto+Naskh+Arabic&family=Tajawal&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <style>
        /* ===== VARIABLES ===== */
        :root {
            /* Primary Colors */
            --primary: #1a472a;
            --primary-light: #2e8b57;
            --primary-dark: #0d2b1a;
            
            /* Secondary Colors */
            --secondary: #3cb371;
            --secondary-light: #50c878;
            --secondary-dark: #2d8b57;
            
            /* Accent Colors */
            --accent: #ffd700;
            --accent-light: #fffacd;
            --accent-dark: #ffc107;
            
            /* Background & Text */
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #1a1a1a;
            --text-muted: #666666;
            
            /* Borders & Shadows */
            --border-color: #e2e8f0;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.12);
            
            /* Spacing */
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 20px;
            --spacing-lg: 30px;
            --spacing-xl: 40px;
            
            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 15px;
            --radius-lg: 25px;
            --radius-xl: 35px;
            
            /* Font Sizes */
            --font-xs: 12px;
            --font-sm: 14px;
            --font-md: 16px;
            --font-lg: 18px;
            --font-xl: 22px;
            --font-xxl: 28px;
            --font-xxxl: 36px;
            
            /* Transitions */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        /* ===== DARK THEME ===== */
        [data-theme="dark"] {
            --bg-color: #0d1b2a;
            --card-bg: #1a2b3c;
            --text-color: #e6e6e6;
            --text-muted: #a0aec0;
            --border-color: #2d3748;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.2);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.4);
        }

        /* ===== RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Tajawal', 'Noto Naskh Arabic', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            transition: background-color var(--transition-normal);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .quran-font {
            font-family: 'Amiri Quran', 'Traditional Arabic', serif;
            font-weight: normal;
            letter-spacing: 0;
        }

        /* ===== TYPOGRAPHY ===== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: var(--spacing-md);
        }

        h1 { font-size: var(--font-xxxl); }
        h2 { font-size: var(--font-xxl); }
        h3 { font-size: var(--font-xl); }
        h4 { font-size: var(--font-lg); }
        h5 { font-size: var(--font-md); }
        h6 { font-size: var(--font-sm); }

        p {
            margin-bottom: var(--spacing-md);
            line-height: 1.8;
        }

        a {
            color: var(--primary);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        a:hover {
            color: var(--secondary);
        }

        /* ===== APP CONTAINER ===== */
        .app-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: var(--spacing-md);
        }

        /* ===== HEADER ===== */
        .app-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: var(--spacing-xl) var(--spacing-lg);
            border-radius: var(--radius-xl);
            margin-bottom: var(--spacing-xl);
            text-align: center;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .app-header::before {
            content: 'ï´¿ï´¾';
            position: absolute;
            font-size: 180px;
            opacity: 0.08;
            right: var(--spacing-lg);
            top: 50%;
            transform: translateY(-50%);
            font-family: 'Amiri Quran';
        }

        .app-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        .app-subtitle {
            opacity: 0.9;
            font-size: var(--font-lg);
            margin-bottom: var(--spacing-lg);
        }

        /* ===== PROGRESS BAR ===== */
        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            padding: var(--spacing-md);
            margin-top: var(--spacing-lg);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
        }

        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--secondary));
            width: 0%;
            transition: width var(--transition-slow);
            border-radius: 5px;
        }

        /* ===== NAVIGATION ===== */
        .app-nav {
            display: flex;
            gap: var(--spacing-sm);
            margin: var(--spacing-xl) 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            flex: 1;
            min-width: 140px;
            padding: var(--spacing-lg) var(--spacing-md);
            background: var(--card-bg);
            border: none;
            border-radius: var(--radius-lg);
            font-size: var(--font-md);
            font-weight: 600;
            color: var(--text-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(26, 71, 42, 0.3);
        }

        .nav-btn i {
            font-size: var(--font-lg);
        }

        /* ===== CONTENT SECTIONS ===== */
        .content-section {
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== CARDS ===== */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--shadow-md);
            border-right: 5px solid var(--primary);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 2px solid var(--border-color);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: var(--font-xl);
            color: var(--primary);
        }

        .card-subtitle {
            color: var(--text-muted);
            font-size: var(--font-sm);
            margin-top: calc(-1 * var(--spacing-md));
            margin-bottom: var(--spacing-lg);
        }

        /* ===== QURAN TEXT ===== */
        .quran-text {
            font-size: var(--font-xxl);
            line-height: 2;
            text-align: center;
            margin: var(--spacing-xl) 0;
            color: var(--primary-dark);
            font-weight: 600;
            padding: var(--spacing-lg);
            background: linear-gradient(to bottom, transparent, rgba(60, 179, 113, 0.05));
            border-radius: var(--radius-md);
            position: relative;
        }

        [data-theme="dark"] .quran-text {
            color: var(--secondary-light);
            background: linear-gradient(to bottom, transparent, rgba(60, 179, 113, 0.1));
        }

        .quran-text::before,
        .quran-text::after {
            content: 'ï´¿';
            position: absolute;
            font-size: 40px;
            color: var(--secondary);
            opacity: 0.3;
        }

        .quran-text::before {
            right: 10px;
            top: 10px;
        }

        .quran-text::after {
            content: 'ï´¾';
            left: 10px;
            bottom: 10px;
        }

        .ayah-number {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: var(--font-sm);
            margin: 0 8px;
            vertical-align: super;
            font-weight: normal;
        }

        /* ===== TAFSIR BOX ===== */
        .tafsir-box {
            background: linear-gradient(135deg, rgba(248, 249, 250, 0.9), rgba(240, 248, 255, 0.95));
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            margin: var(--spacing-xl) 0;
            border-right: 4px solid var(--secondary);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .tafsir-box {
            background: linear-gradient(135deg, rgba(26, 43, 60, 0.9), rgba(32, 54, 75, 0.95));
        }

        .tafsir-box::before {
            content: 'Øª';
            position: absolute;
            font-size: 120px;
            opacity: 0.03;
            right: 20px;
            top: 10px;
            font-family: 'Amiri Quran';
        }

        .tafsir-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
            color: var(--secondary);
        }

        /* ===== INFO GRID ===== */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
        }

        .info-item {
            background: rgba(60, 179, 113, 0.08);
            padding: var(--spacing-lg);
            border-radius: var(--radius-md);
            text-align: center;
            transition: all var(--transition-normal);
            border: 1px solid transparent;
        }

        .info-item:hover {
            transform: translateY(-5px);
            background: rgba(60, 179, 113, 0.15);
            border-color: var(--primary);
            box-shadow: var(--shadow-sm);
        }

        .info-icon {
            font-size: var(--font-xl);
            color: var(--primary);
            margin-bottom: var(--spacing-sm);
            display: block;
        }

        .info-label {
            font-size: var(--font-sm);
            color: var(--text-muted);
            margin-bottom: var(--spacing-xs);
        }

        .info-value {
            font-size: var(--font-md);
            font-weight: 600;
            color: var(--text-color);
        }

        /* ===== BUTTONS ===== */
        .btn {
            padding: var(--spacing-lg) var(--spacing-xl);
            border: none;
            border-radius: var(--radius-md);
            font-size: var(--font-md);
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            transition: all var(--transition-normal);
            width: 100%;
            margin: var(--spacing-sm) 0;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .btn:hover::after {
            opacity: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 6px 20px rgba(26, 71, 42, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(26, 71, 42, 0.4);
        }

        .btn-secondary {
            background: rgba(60, 179, 113, 0.1);
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(60, 179, 113, 0.2);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #fd7e14);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #17a2b8, #0dcaf0);
            color: white;
        }

        /* ===== PAGE NAVIGATION ===== */
        .page-nav {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
        }

        .page-btn {
            flex: 1;
            padding: var(--spacing-lg);
            background: var(--card-bg);
            border: 2px solid var(--primary);
            border-radius: var(--radius-md);
            font-size: var(--font-md);
            color: var(--primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            transition: all var(--transition-normal);
        }

        .page-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* ===== SURAH SELECTOR ===== */
        .surah-selector {
            position: relative;
            margin: var(--spacing-xl) 0;
        }

        .surah-select {
            width: 100%;
            padding: var(--spacing-lg) 50px var(--spacing-lg) var(--spacing-lg);
            border: 2px solid var(--primary);
            border-radius: var(--radius-md);
            font-size: var(--font-md);
            background: var(--card-bg);
            color: var(--text-color);
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%231a472a' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: left var(--spacing-lg) center;
            background-size: 20px;
            cursor: pointer;
            transition: border-color var(--transition-normal);
        }

        [data-theme="dark"] .surah-select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233cb371' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        }

        .surah-select:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(60, 179, 113, 0.2);
        }

        /* ===== PAGE SLIDER ===== */
        .page-slider-container {
            background: var(--card-bg);
            padding: var(--spacing-xl);
            border-radius: var(--radius-lg);
            margin: var(--spacing-xl) 0;
            box-shadow: var(--shadow-md);
        }

        .page-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 4px;
            outline: none;
            margin: var(--spacing-lg) 0;
        }

        .page-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 3px solid var(--primary);
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
        }

        .page-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: var(--primary);
        }

        .page-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: var(--spacing-md);
            font-size: var(--font-md);
            font-weight: 600;
            color: var(--primary);
        }

        /* ===== AYAH LIST ===== */
        .ayah-list-container {
            max-height: 600px;
            overflow-y: auto;
            padding: var(--spacing-md);
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            margin: var(--spacing-xl) 0;
            box-shadow: var(--shadow-sm);
        }

        .ayah-list-container::-webkit-scrollbar {
            width: 8px;
        }

        .ayah-list-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
        }

        .ayah-list-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        .ayah-list-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }

        .ayah-item {
            padding: var(--spacing-lg);
            margin: var(--spacing-md) 0;
            background: rgba(60, 179, 113, 0.05);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            border-right: 3px solid transparent;
            position: relative;
        }

        .ayah-item:hover {
            background: rgba(60, 179, 113, 0.1);
            border-right-color: var(--primary);
            transform: translateX(-5px);
            box-shadow: var(--shadow-sm);
        }

        .ayah-item.active {
            background: rgba(60, 179, 113, 0.15);
            border-right-color: var(--primary);
            box-shadow: var(--shadow-md);
        }

        .ayah-item-number {
            position: absolute;
            left: var(--spacing-md);
            top: var(--spacing-md);
            background: var(--primary);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-sm);
            font-weight: 600;
        }

        .ayah-item-content {
            margin-right: 45px;
        }

        .ayah-item-actions {
            display: flex;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-md);
            justify-content: flex-end;
        }

        /* ===== REMINDERS ===== */
        .reminder-card {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            margin: var(--spacing-xl) 0;
            border: 2px solid #ffc107;
        }

        [data-theme="dark"] .reminder-card {
            background: linear-gradient(135deg, #4a3c00, #6b5b00);
            border-color: #ffc107;
        }

        .reminder-controls {
            display: flex;
            gap: var(--spacing-md);
            margin: var(--spacing-lg) 0;
            align-items: center;
        }

        .reminder-time {
            flex: 1;
            padding: var(--spacing-md);
            border: 2px solid var(--primary);
            border-radius: var(--radius-md);
            font-size: var(--font-md);
            background: white;
            color: var(--text-color);
        }

        /* ===== SETTINGS ===== */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin: var(--spacing-xl) 0;
        }

        .setting-item {
            background: var(--card-bg);
            padding: var(--spacing-lg);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .setting-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
            color: var(--primary);
        }

        /* Switches */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Font Selector */
        .font-selector {
            display: flex;
            gap: var(--spacing-md);
            margin: var(--spacing-md) 0;
        }

        .font-option {
            flex: 1;
            padding: var(--spacing-md);
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .font-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .font-option.active {
            border-color: var(--primary);
            background: rgba(60, 179, 113, 0.1);
            transform: translateY(-2px);
        }

        .font-option.amiri {
            font-family: 'Amiri Quran';
            font-size: var(--font-lg);
        }

        .font-option.uthmani {
            font-family: 'Traditional Arabic';
            font-size: var(--font-lg);
        }

        .font-option.naskh {
            font-family: 'Noto Naskh Arabic';
            font-size: var(--font-lg);
        }

        /* ===== LOADING & EMPTY STATES ===== */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-xl);
            color: var(--text-muted);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--border-color);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: var(--spacing-md);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: var(--spacing-xl);
            color: var(--text-muted);
            font-style: italic;
        }

        /* ===== NOTIFICATIONS ===== */
        .notification-permission {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            text-align: center;
            margin: var(--spacing-xl) 0;
            border: 2px solid #28a745;
        }

        [data-theme="dark"] .notification-permission {
            background: linear-gradient(135deg, #1c3b1c, #2d4d2d);
        }

        /* ===== OFFLINE INDICATOR ===== */
        .offline-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #dc3545;
            color: white;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--radius-md);
            display: none;
            align-items: center;
            gap: var(--spacing-sm);
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* ===== INSTALL BUTTON ===== */
        .install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: none;
            align-items: center;
            gap: var(--spacing-sm);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .install-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(26, 71, 42, 0.4);
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .app-nav {
                flex-direction: column;
            }
            
            .nav-btn {
                min-width: 100%;
            }
            
            .quran-text {
                font-size: var(--font-xl);
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .page-nav {
                flex-direction: column;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .ayah-item-content {
                margin-right: 0;
                margin-top: 30px;
            }
            
            .ayah-item-number {
                position: relative;
                top: 0;
                left: 0;
                margin-bottom: var(--spacing-sm);
            }
        }

        @media (max-width: 480px) {
            .app-header {
                padding: var(--spacing-lg);
            }
            
            .app-title {
                font-size: var(--font-xxl);
            }
            
            .app-subtitle {
                font-size: var(--font-md);
            }
            
            .card {
                padding: var(--spacing-lg);
            }
            
            .reminder-controls {
                flex-direction: column;
            }
            
            .reminder-time {
                width: 100%;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        .text-muted { color: var(--text-muted); }
        .text-primary { color: var(--primary); }
        .text-success { color: #28a745; }
        .text-danger { color: #dc3545; }
        .text-warning { color: #ffc107; }
        .text-info { color: #17a2b8; }
        
        .mt-10 { margin-top: 10px; }
        .mt-20 { margin-top: 20px; }
        .mt-30 { margin-top: 30px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
        .mb-30 { margin-bottom: 30px; }
        .my-20 { margin-top: 20px; margin-bottom: 20px; }
        
        .p-10 { padding: 10px; }
        .p-20 { padding: 20px; }
        .p-30 { padding: 30px; }
        
        .d-flex { display: flex; }
        .d-block { display: block; }
        .d-inline { display: inline; }
        .d-inline-block { display: inline-block; }
        
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .justify-end { justify-content: flex-end; }
        
        .align-center { align-items: center; }
        .align-start { align-items: flex-start; }
        .align-end { align-items: flex-end; }
        
        .flex-column { flex-direction: column; }
        .flex-row { flex-direction: row; }
        
        .gap-10 { gap: 10px; }
        .gap-20 { gap: 20px; }
        .gap-30 { gap: 30px; }
        
        .w-100 { width: 100%; }
        .w-50 { width: 50%; }
        .w-25 { width: 25%; }
        
        .rounded { border-radius: var(--radius-md); }
        .rounded-lg { border-radius: var(--radius-lg); }
        .rounded-circle { border-radius: 50%; }
        
        .shadow { box-shadow: var(--shadow-md); }
        .shadow-sm { box-shadow: var(--shadow-sm); }
        .shadow-lg { box-shadow: var(--shadow-lg); }
        
        .cursor-pointer { cursor: pointer; }
        .cursor-default { cursor: default; }
        
        .position-relative { position: relative; }
        .position-absolute { position: absolute; }
        .position-fixed { position: fixed; }
        
        .overflow-hidden { overflow: hidden; }
        .overflow-auto { overflow: auto; }
        .overflow-scroll { overflow: scroll; }
        
        .z-1 { z-index: 1; }
        .z-10 { z-index: 10; }
        .z-100 { z-index: 100; }
        .z-1000 { z-index: 1000; }
    </style>
</head>
<body>
    <!-- App Container -->
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="app-title">
                <i class="fas fa-quran"></i>
                <h1>Ù…ØµØ­Ù Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h1>
            </div>
            <p class="app-subtitle">Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© - 114 Ø³ÙˆØ±Ø© - 604 ØµÙØ­Ø© - Ù…Ø¹ Ø§Ù„ØªÙØ³ÙŠØ± ÙˆØ§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª</p>
            
            <div class="progress-container">
                <div class="progress-info">
                    <span id="progress-text">Ø§Ù„ØªÙ‚Ø¯Ù…: <strong>0%</strong></span>
                    <span id="stats-text">ğŸ“– 0 Ø¢ÙŠØ© | â±ï¸ 0 Ø¯Ù‚ÙŠÙ‚Ø©</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="app-nav">
            <button class="nav-btn active" onclick="showSection('daily')">
                <i class="fas fa-calendar-day"></i> <span>Ø§Ù„ÙŠÙˆÙ…</span>
            </button>
            <button class="nav-btn" onclick="showSection('mushaf')">
                <i class="fas fa-book-quran"></i> <span>Ø§Ù„Ù…ØµØ­Ù</span>
            </button>
            <button class="nav-btn" onclick="showSection('pages')">
                <i class="fas fa-file-alt"></i> <span>Ø§Ù„ØµÙØ­Ø§Øª</span>
            </button>
            <button class="nav-btn" onclick="showSection('tafsir')">
                <i class="fas fa-book-open"></i> <span>Ø§Ù„ØªÙØ³ÙŠØ±</span>
            </button>
            <button class="nav-btn" onclick="showSection('search')">
                <i class="fas fa-search"></i> <span>Ø¨Ø­Ø«</span>
            </button>
            <button class="nav-btn" onclick="showSection('bookmarks')">
                <i class="fas fa-bookmark"></i> <span>Ù…Ø­ÙÙˆØ¸Ø§Øª</span>
            </button>
            <button class="nav-btn" onclick="showSection('progress')">
                <i class="fas fa-chart-line"></i> <span>ØªÙ‚Ø¯Ù…</span>
            </button>
            <button class="nav-btn" onclick="showSection('reminders')">
                <i class="fas fa-bell"></i> <span>ØªØ°ÙƒÙŠØ±Ø§Øª</span>
            </button>
            <button class="nav-btn" onclick="showSection('settings')">
                <i class="fas fa-cog"></i> <span>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
            </button>
        </nav>

        <!-- Daily Section -->
        <section id="daily-section" class="content-section active">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-sun"></i> Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
                    <span class="text-muted" id="today-date"></span>
                </div>
                
                <div id="daily-content" class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¢ÙŠØ© Ø§Ù„ÙŠÙˆÙ…...</p>
                </div>
            </div>
        </section>

        <!-- Mushaf Section -->
        <section id="mushaf-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-book-quran"></i> Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ</h2>
                    <span class="text-muted" id="mushaf-info">114 Ø³ÙˆØ±Ø©</span>
                </div>
                
                <div class="surah-selector">
                    <select class="surah-select" id="surah-select" onchange="loadSurah()">
                        <option value="">Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©...</option>
                    </select>
                </div>
                
                <div id="mushaf-content" class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØµØ­Ù...</p>
                </div>
                
                <div class="page-nav">
                    <button class="page-btn" onclick="prevSurah()" id="prev-surah-btn">
                        <i class="fas fa-chevron-right"></i> Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                    </button>
                    <button class="page-btn" onclick="nextSurah()" id="next-surah-btn">
                        Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© <i class="fas fa-chevron-left"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Pages Section -->
        <section id="pages-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-file-alt"></i> ØªØµÙØ­ Ø§Ù„Ù…ØµØ­Ù ØµÙØ­Ø© ØµÙØ­Ø©</h2>
                    <span class="text-muted" id="page-range">Ø§Ù„ØµÙØ­Ø© 1 Ù…Ù† 604</span>
                </div>
                
                <div class="page-slider-container">
                    <div class="page-info">
                        <span>Ø§Ù„ØµÙØ­Ø© 1</span>
                        <span>604 ØµÙØ­Ø©</span>
                    </div>
                    <input type="range" class="page-slider" id="page-slider" min="1" max="604" value="1">
                    <div class="page-info">
                        <span>1</span>
                        <span id="current-page-text">Ø§Ù„ØµÙØ­Ø© 1</span>
                        <span>604</span>
                    </div>
                </div>
                
                <div id="page-content" class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø©...</p>
                </div>
                
                <div class="page-nav">
                    <button class="page-btn" onclick="prevPage()" id="prev-page-btn">
                        <i class="fas fa-chevron-right"></i> Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                    </button>
                    <button class="page-btn" onclick="nextPage()" id="next-page-btn">
                        Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© <i class="fas fa-chevron-left"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Tafsir Section -->
        <section id="tafsir-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-book-open"></i> ØªÙØ³ÙŠØ± Ø§Ù„Ø¢ÙŠØ©</h2>
                    <span class="text-muted" id="selected-ayah-info">Ø§Ø®ØªØ± Ø¢ÙŠØ©</span>
                </div>
                
                <div id="tafsir-content" class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø§Ø®ØªØ± Ø¢ÙŠØ© Ù„Ø±Ø¤ÙŠØ© ØªÙØ³ÙŠØ±Ù‡Ø§...</p>
                </div>
            </div>
        </section>

        <!-- Search Section -->
        <section id="search-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-search"></i> Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†</h2>
                    <span class="text-muted">Ø§Ø¨Ø­Ø« ÙÙŠ Ù†Øµ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</span>
                </div>
                
                <div class="mb-30">
                    <div class="d-flex gap-10">
                        <input type="text" id="search-input" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø¹Ø¨Ø§Ø±Ø© Ù„Ù„Ø¨Ø­Ø«..." 
                               class="w-100 p-20 rounded" style="border: 2px solid var(--primary);">
                        <button class="btn btn-primary" onclick="searchInQuran()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="d-flex gap-10 mt-20">
                        <select id="search-type" class="p-10 rounded" style="border: 1px solid var(--border-color);">
                            <option value="all">Ø¨Ø­Ø« ÙÙŠ ÙƒÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†</option>
                            <option value="surah">Ø¨Ø­Ø« ÙÙŠ Ø³ÙˆØ±Ø© Ù…Ø­Ø¯Ø¯Ø©</option>
                            <option value="tafsir">Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØªÙØ³ÙŠØ±</option>
                        </select>
                        <select id="search-surah" class="p-10 rounded" style="border: 1px solid var(--border-color); display: none;">
                            <option value="">Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©...</option>
                        </select>
                    </div>
                </div>
                
                <div id="search-results">
                    <p class="text-center text-muted">Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</p>
                </div>
            </div>
        </section>

        <!-- Bookmarks Section -->
        <section id="bookmarks-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-bookmark"></i> Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h2>
                    <span class="text-muted" id="bookmarks-count">0 Ø¢ÙŠØ©</span>
                </div>
                
                <div id="bookmarks-content">
                    <p class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¢ÙŠØ§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø¹Ø¯</p>
                </div>
                
                <div class="text-center mt-20">
                    <button class="btn btn-danger" onclick="clearAllBookmarks()">
                        <i class="fas fa-trash"></i> Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª
                    </button>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section id="progress-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-chart-line"></i> ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</h2>
                    <span class="text-muted">Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</span>
                </div>
                
                <div class="info-grid">
                    <div class="info-item">
                        <i class="fas fa-fire info-icon"></i>
                        <div class="info-label">Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØªØ§Ù„ÙŠØ©</div>
                        <div class="info-value" id="stats-streak">0 ÙŠÙˆÙ…</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-book info-icon"></i>
                        <div class="info-label">Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©</div>
                        <div class="info-value" id="stats-ayahs">0 Ø¢ÙŠØ©</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-clock info-icon"></i>
                        <div class="info-label">ÙˆÙ‚Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</div>
                        <div class="info-value" id="stats-time">0 Ø¯Ù‚ÙŠÙ‚Ø©</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-trophy info-icon"></i>
                        <div class="info-label">Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</div>
                        <div class="info-value" id="stats-completion">0%</div>
                    </div>
                </div>
                
                <div class="card mt-20">
                    <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Ù†Ø´Ø§Ø· Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
                    <div id="weekly-chart" class="mt-20">
                        <div style="height: 200px; display: flex; align-items: flex-end; gap: 10px;">
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-1"></div>
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-2"></div>
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-3"></div>
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-4"></div>
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-5"></div>
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-6"></div>
                            <div style="flex: 1; background: var(--primary); border-radius: 5px 5px 0 0;" id="day-7"></div>
                        </div>
                        <div class="d-flex justify-between mt-10">
                            <span>Ø£</span>
                            <span>Ø¥</span>
                            <span>Ø«</span>
                            <span>Ø£</span>
                            <span>Ø®</span>
                            <span>Ø¬</span>
                            <span>Ø³</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reminders Section -->
        <section id="reminders-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-bell"></i> Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
                    <span class="text-muted">Ø§Ø¶Ø¨Ø· ØªØ°ÙƒÙŠØ±Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø©</span>
                </div>
                
                <div class="reminder-card">
                    <h3 class="mb-20"><i class="fas fa-clock"></i> ÙˆÙ‚Øª Ø§Ù„ØªØ°ÙƒÙŠØ±</h3>
                    
                    <div class="reminder-controls">
                        <input type="time" id="reminder-time-input" value="05:00" class="reminder-time">
                        <button class="btn btn-primary" onclick="saveReminder()">
                            <i class="fas fa-save"></i> Ø­ÙØ¸
                        </button>
                    </div>
                    
                    <div class="d-flex gap-10 mt-20">
                        <button class="btn btn-secondary" onclick="enableNotifications()">
                            <i class="fas fa-bell"></i> ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                        </button>
                        <button class="btn btn-info" onclick="testNotification()">
                            <i class="fas fa-bell"></i> ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¢Ù†
                        </button>
                    </div>
                </div>
                
                <div class="notification-permission hidden" id="notification-permission-box">
                    <h3><i class="fas fa-bell-slash"></i> ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
                    <p class="mb-20">Ù„ØªÙ„Ù‚ÙŠ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>
                    <button class="btn btn-primary" onclick="requestNotificationPermission()">
                        ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¢Ù†
                    </button>
                </div>
                
                <div class="card mt-20">
                    <h3 class="card-title"><i class="fas fa-history"></i> Ø³Ø¬Ù„ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª</h3>
                    <div id="reminders-history" class="mt-20">
                        <p class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ°ÙƒÙŠØ±Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-cog"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
                    <span class="text-muted">Ø®ØµÙÙ‘Øµ ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹ Ø§Ù„Ù…ØµØ­Ù</span>
                </div>
                
                <div class="settings-grid">
                    <!-- Appearance Settings -->
                    <div class="setting-item">
                        <h3 class="setting-title"><i class="fas fa-paint-brush"></i> Ø§Ù„Ù…Ø¸Ù‡Ø±</h3>
                        
                        <div class="mb-20">
                            <label class="d-flex align-center gap-10 mb-10 cursor-pointer">
                                <span class="switch">
                                    <input type="checkbox" id="dark-mode-toggle">
                                    <span class="slider"></span>
                                </span>
                                <span>Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</span>
                            </label>
                        </div>
                        
                        <div class="mb-20">
                            <label class="d-block mb-10">Ù„ÙˆÙ† Ø§Ù„Ø³Ù…Ø©:</label>
                            <div class="d-flex gap-10">
                                <div class="color-option" style="background: #1a472a;" onclick="changeThemeColor('#1a472a')"></div>
                                <div class="color-option" style="background: #2c3e50;" onclick="changeThemeColor('#2c3e50')"></div>
                                <div class="color-option" style="background: #8b4513;" onclick="changeThemeColor('#8b4513')"></div>
                                <div class="color-option" style="background: #4a235a;" onclick="changeThemeColor('#4a235a')"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quran Font Settings -->
                    <div class="setting-item">
                        <h3 class="setting-title"><i class="fas fa-font"></i> Ø®Ø· Ø§Ù„Ù‚Ø±Ø¢Ù†</h3>
                        
                        <div class="mb-20">
                            <label class="d-block mb-10">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·:</label>
                            <div class="font-selector">
                                <div class="font-option amiri active" onclick="changeFont('amiri')">
                                    Ø£Ù…ÙŠØ±ÙŠ
                                </div>
                                <div class="font-option uthmani" onclick="changeFont('uthmani')">
                                    Ø¹Ø«Ù…Ø§Ù†ÙŠ
                                </div>
                                <div class="font-option naskh" onclick="changeFont('naskh')">
                                    Ù†Ø³Ø®
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-20">
                            <label class="d-block mb-10">Ø­Ø¬Ù… Ø§Ù„Ø®Ø·: <span id="font-size-value">28px</span></label>
                            <input type="range" id="font-size-slider" min="20" max="40" value="28" 
                                   class="w-100" oninput="changeFontSize(this.value)">
                        </div>
                    </div>
                    
                    <!-- Reading Settings -->
                    <div class="setting-item">
                        <h3 class="setting-title"><i class="fas fa-book-reader"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</h3>
                        
                        <div class="mb-20">
                            <label class="d-flex align-center gap-10 mb-10 cursor-pointer">
                                <span class="switch">
                                    <input type="checkbox" id="auto-scroll-toggle" checked>
                                    <span class="slider"></span>
                                </span>
                                <span>Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                            </label>
                        </div>
                        
                        <div class="mb-20">
                            <label class="d-flex align-center gap-10 mb-10 cursor-pointer">
                                <span class="switch">
                                    <input type="checkbox" id="show-tafsir-toggle" checked>
                                    <span class="slider"></span>
                                </span>
                                <span>Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ³ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</span>
                            </label>
                        </div>
                        
                        <div class="mb-20">
                            <label class="d-flex align-center gap-10 mb-10 cursor-pointer">
                                <span class="switch">
                                    <input type="checkbox" id="auto-save-toggle" checked>
                                    <span class="slider"></span>
                                </span>
                                <span>Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Data Management -->
                    <div class="setting-item">
                        <h3 class="setting-title"><i class="fas fa-database"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                        
                        <div class="mb-20">
                            <p class="text-muted mb-10">Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</p>
                            <div class="progress-bar" style="height: 8px;">
                                <div class="progress-fill" id="storage-bar" style="width: 25%;"></div>
                            </div>
                            <div class="d-flex justify-between mt-10">
                                <span id="storage-used">2.5 MB</span>
                                <span id="storage-total">10 MB</span>
                            </div>
                        </div>
                        
                        <div class="d-flex flex-column gap-10">
                            <button class="btn btn-info" onclick="exportData()">
                                <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                            <button class="btn btn-secondary" onclick="importData()">
                                <i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª
                            </button>
                            <button class="btn btn-warning" onclick="backupData()">
                                <i class="fas fa-copy"></i> Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ
                            </button>
                        </div>
                    </div>
                    
                    <!-- Reset Settings -->
                    <div class="setting-item">
                        <h3 class="setting-title"><i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†</h3>
                        <p class="text-muted mb-20">ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø£Ø¬Ø²Ø§Ø¡ Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£Ùˆ ÙƒÙ„Ù‡</p>
                        
                        <div class="d-flex flex-column gap-10">
                            <button class="btn btn-secondary" onclick="resetProgressOnly()">
                                <i class="fas fa-trash"></i> ØªØµÙÙŠØ± Ø§Ù„ØªÙ‚Ø¯Ù… ÙÙ‚Ø·
                            </button>
                            
                            <button class="btn btn-secondary" onclick="resetBookmarksOnly()">
                                <i class="far fa-bookmark"></i> ØªØµÙÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª ÙÙ‚Ø·
                            </button>
                            
                            <button class="btn btn-secondary" onclick="resetSettingsOnly()">
                                <i class="fas fa-sliders-h"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                            </button>
                            
                            <button class="btn btn-danger" onclick="resetEverything()">
                                <i class="fas fa-bomb"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø©
                            </button>
                        </div>
                        
                        <p class="text-danger mt-20" style="font-size: 12px;">
                            <i class="fas fa-exclamation-triangle"></i>
                            ØªØ­Ø°ÙŠØ±: Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡Ø§
                        </p>
                    </div>
                    
                    <!-- App Info -->
                    <div class="setting-item">
                        <h3 class="setting-title"><i class="fas fa-info-circle"></i> Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3>
                        
                        <div class="mb-20">
                            <p><strong>Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</strong> <span id="app-version">3.0.0</span></p>
                            <p><strong>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:</strong> <span id="last-update">2024</span></p>
                            <p><strong>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> <span id="data-status">Ù…Ø­Ù…Ù„Ø©</span></p>
                            <p><strong>Ø§Ù„Ù‚Ø±Ø¢Ù†:</strong> <span id="quran-status">114 Ø³ÙˆØ±Ø©</span></p>
                        </div>
                        
                        <button class="btn btn-primary" onclick="checkForUpdates()">
                            <i class="fas fa-sync"></i> Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
                        </button>
                        
                        <button class="btn btn-secondary mt-10" onclick="installApp()">
                            <i class="fas fa-download"></i> ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Install Button -->
    <div class="install-btn" id="install-btn">
        <i class="fas fa-download"></i>
        <span>ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
    </div>

    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offline-indicator">
        <i class="fas fa-wifi-slash"></i>
        <span>Ø£Ù†Øª ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</span>
    </div>

    <!-- Audio Player (Hidden) -->
    <audio id="audio-player" hidden></audio>

    <!-- JavaScript -->
    <script>
        // ============================================
        // APPLICATION STATE & CONFIGURATION
        // ============================================
        
        const APP_CONFIG = {
            name: "Ù…ØµØ­Ù Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…",
            version: "3.0.0",
            dataVersion: "1.0",
            cacheName: "quran-app-complete-v3",
            dataUrls: {
                quran: "https://cdn.jsdelivr.net/gh/fawazahmed0/quran-api@1/editions/ara-quranuthmani.json",
                tafsir: "https://cdn.jsdelivr.net/gh/fawazahmed0/quran-api@1/editions/ara-muyassartafseer.json",
                surahInfo: "https://api.alquran.cloud/v1/meta",
                pages: "https://api.alquran.cloud/v1/page"
            }
        };

        let appState = {
            // Quran Data
            quranData: null,
            tafsirData: null,
            surahInfo: null,
            pagesData: {},
            
            // Current State
            currentSection: "daily",
            currentSurah: 1,
            currentAyah: 1,
            currentPage: 1,
            currentFont: "amiri",
            currentFontSize: 28,
            
            // User Progress
            progress: {
                readAyahs: 0,
                readPages: new Set(),
                readingTime: 0, // in minutes
                streak: 0,
                lastRead: null,
                dailyProgress: {},
                bookmarks: [],
                notes: {},
                completedSurahs: new Set()
            },
            
            // Settings
            settings: {
                theme: "light",
                themeColor: "#1a472a",
                autoSave: true,
                autoScroll: true,
                showTafsir: true,
                reminderTime: "05:00",
                notifications: false,
                fontSize: 28,
                fontFamily: "amiri"
            },
            
            // App Data
            searchHistory: [],
            reminders: [],
            lastBackup: null,
            firstInstall: new Date().toISOString()
        };

        // ============================================
        // INITIALIZATION
        // ============================================

        async function initializeApp() {
            console.log("ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØ­Ù Ø§Ù„ÙƒØ§Ù…Ù„...");
            
            showLoading("Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...");
            
            try {
                // Load saved state
                loadAppState();
                
                // Apply settings
                applySettings();
                
                // Initialize UI
                initializeUI();
                
                // Load Quran data
                await loadQuranData();
                
                // Load additional data
                await loadAdditionalData();
                
                // Setup event listeners
                setupEventListeners();
                
                // Initialize sections
                initializeSections();
                
                // Check connectivity
                checkConnectivity();
                
                // Schedule reminders
                scheduleReminders();
                
                console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!");
                hideLoading();
                
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:", error);
                showError("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚. Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰...");
                setTimeout(initializeApp, 3000);
            }
        }

        // ============================================
        // DATA LOADING FUNCTIONS
        // ============================================

        async function loadQuranData() {
            try {
                // Try to load from cache first
                const cached = localStorage.getItem("quranData");
                if (cached) {
                    appState.quranData = JSON.parse(cached);
                    console.log("ğŸ“– ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©");
                } else {
                    // Load from API
                    showLoading("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…...");
                    const response = await fetch(APP_CONFIG.dataUrls.quran);
                    if (!response.ok) throw new Error("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†");
                    
                    const data = await response.json();
                    appState.quranData = data.quran || data;
                    
                    // Cache for offline use
                    localStorage.setItem("quranData", JSON.stringify(appState.quranData));
                    console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª");
                }
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†:", error);
                // Load sample data as fallback
                appState.quranData = getSampleQuranData();
            }
        }

        async function loadAdditionalData() {
            try {
                // Load Tafsir
                const tafsirCached = localStorage.getItem("tafsirData");
                if (tafsirCached) {
                    appState.tafsirData = JSON.parse(tafsirCached);
                } else {
                    const response = await fetch(APP_CONFIG.dataUrls.tafsir);
                    const data = await response.json();
                    appState.tafsirData = data.quran || data;
                    localStorage.setItem("tafsirData", JSON.stringify(appState.tafsirData));
                }

                // Load Surah Info
                const surahCached = localStorage.getItem("surahInfo");
                if (surahCached) {
                    appState.surahInfo = JSON.parse(surahCached);
                } else {
                    const response = await fetch(APP_CONFIG.dataUrls.surahInfo);
                    const data = await response.json();
                    appState.surahInfo = data.data.surahs.references;
                    localStorage.setItem("surahInfo", JSON.stringify(appState.surahInfo));
                }

                // Generate pages data
                generatePagesData();
                
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©:", error);
            }
        }

        function generatePagesData() {
            // This is a simplified version. In production, you would use actual page data
            appState.pagesData = {};
            for (let i = 1; i <= 604; i++) {
                appState.pagesData[i] = {
                    number: i,
                    content: `Ø§Ù„ØµÙØ­Ø© ${i} Ù…Ù† Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ`,
                    ayahs: [],
                    surahs: []
                };
            }
        }

        // ============================================
        // STATE MANAGEMENT
        // ============================================

        function loadAppState() {
            try {
                const saved = localStorage.getItem("quranAppState");
                if (saved) {
                    const parsed = JSON.parse(saved);
                    
                    // Merge with current state, preserving defaults for new properties
                    appState = {
                        ...appState,
                        ...parsed,
                        progress: {
                            ...appState.progress,
                            ...parsed.progress,
                            readPages: new Set(parsed.progress?.readPages || []),
                            completedSurahs: new Set(parsed.progress?.completedSurahs || []),
                            bookmarks: parsed.progress?.bookmarks || []
                        }
                    };
                    
                    console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©");
                }
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©:", error);
            }
        }

        function saveAppState() {
            if (!appState.settings.autoSave) return;
            
            try {
                // Convert Sets to Arrays for JSON serialization
                const stateToSave = {
                    ...appState,
                    progress: {
                        ...appState.progress,
                        readPages: Array.from(appState.progress.readPages),
                        completedSurahs: Array.from(appState.progress.completedSurahs)
                    }
                };
                
                localStorage.setItem("quranAppState", JSON.stringify(stateToSave));
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©:", error);
            }
        }

        // ============================================
        // UI FUNCTIONS
        // ============================================

        function initializeUI() {
            // Update date
            updateDate();
            
            // Populate surah select
            populateSurahSelect();
            
            // Setup navigation
            setupNavigation();
            
            // Update progress display
            updateProgressDisplay();
            
            // Apply current theme
            applyTheme();
        }

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll(".content-section").forEach(section => {
                section.classList.remove("active");
            });
            
            // Deactivate all nav buttons
            document.querySelectorAll(".nav-btn").forEach(btn => {
                btn.classList.remove("active");
            });
            
            // Show selected section
            const section = document.getElementById(`${sectionId}-section`);
            if (section) {
                section.classList.add("active");
                
                // Load section content if needed
                loadSectionContent(sectionId);
            }
            
            // Activate clicked button
            event.target.classList.add("active");
            
            // Update current section
            appState.currentSection = sectionId;
            
            // Save state
            saveAppState();
        }

        function loadSectionContent(sectionId) {
            switch (sectionId) {
                case "daily":
                    loadDailyAyah();
                    break;
                case "mushaf":
                    loadCurrentSurah();
                    break;
                case "pages":
                    loadCurrentPage();
                    break;
                case "bookmarks":
                    loadBookmarks();
                    break;
                case "progress":
                    updateStats();
                    break;
            }
        }

        // ============================================
        // DAILY SECTION
        // ============================================

        function loadDailyAyah() {
            if (!appState.quranData || !appState.surahInfo) return;
            
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
            
            // Select random surah and ayah based on day
            const surahIndex = dayOfYear % appState.surahInfo.length;
            const surahNumber = appState.surahInfo[surahIndex].number;
            const surah = appState.quranData[surahNumber];
            
            if (!surah || !surah.ayahs) return;
            
            const ayahIndex = dayOfYear % surah.ayahs.length;
            const ayah = surah.ayahs[ayahIndex] || surah.ayahs[0];
            
            if (!ayah) return;
            
            const dailyContent = document.getElementById("daily-content");
            dailyContent.innerHTML = `
                <div class="quran-text">
                    ${ayah.text}
                    <span class="ayah-number">${ayah.number}</span>
                </div>
                
                <div class="tafsir-box">
                    <div class="tafsir-title">
                        <i class="fas fa-graduation-cap"></i>
                        <h3>Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±</h3>
                    </div>
                    <p>${getTafsir(surahNumber, ayah.number) || "Ø§Ù„ØªÙØ³ÙŠØ± ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹."}</p>
                </div>
                
                <div class="info-grid">
                    <div class="info-item">
                        <i class="fas fa-mosque info-icon"></i>
                        <div class="info-label">Ø§Ù„Ø³ÙˆØ±Ø©</div>
                        <div class="info-value">${surah.name}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-hashtag info-icon"></i>
                        <div class="info-label">Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©</div>
                        <div class="info-value">${ayah.number}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-star info-icon"></i>
                        <div class="info-label">Ø§Ù„Ù†ÙˆØ¹</div>
                        <div class="info-value">${appState.surahInfo[surahIndex].revelationType === "Meccan" ? "Ù…ÙƒÙŠØ©" : "Ù…Ø¯Ù†ÙŠØ©"}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-book info-icon"></i>
                        <div class="info-label">Ø¢ÙŠØ§Øª Ø§Ù„Ø³ÙˆØ±Ø©</div>
                        <div class="info-value">${surah.ayahs.length}</div>
                    </div>
                </div>
                
                <div class="card mt-30">
                    <h3 class="card-title"><i class="fas fa-lightbulb"></i> ÙˆÙ‚ÙØ© Ø¥ÙŠÙ…Ø§Ù†ÙŠØ©</h3>
                    <p>ØªØ£Ù…Ù„ ÙÙŠ Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø¢ÙŠØ© ÙˆØ­Ø§ÙˆÙ„ ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§ ÙÙŠ ÙŠÙˆÙ…Ùƒ.</p>
                </div>
                
                <div class="card mt-20">
                    <h3 class="card-title"><i class="fas fa-check-circle"></i> ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙŠÙˆÙ…</h3>
                    <p>Ø­Ø§ÙˆÙ„ Ø£Ù† ØªØ±Ø¯Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø¢ÙŠØ© ${ayah.number} Ù…Ø±Ø© Ø§Ù„ÙŠÙˆÙ… ÙˆØªÙÙƒØ± ÙÙŠ Ù…Ø¹Ù†Ø§Ù‡Ø§.</p>
                    <div class="d-flex gap-10 mt-20">
                        <button class="btn btn-primary" onclick="bookmarkAyah(${surahNumber}, ${ayah.number})">
                            <i class="far fa-bookmark"></i> Ø­ÙØ¸ Ø§Ù„Ø¢ÙŠØ©
                        </button>
                        <button class="btn btn-success" onclick="markAyahAsRead(${surahNumber}, ${ayah.number})">
                            <i class="fas fa-check"></i> ØªÙ…Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
                        </button>
                    </div>
                </div>
            `;
            
            // Update progress
            appState.progress.readAyahs++;
            appState.progress.lastRead = new Date().toISOString();
            updateProgressDisplay();
            saveAppState();
        }

        // ============================================
        // MUSHAF SECTION
        // ============================================

        function populateSurahSelect() {
            const select = document.getElementById("surah-select");
            if (!select || !appState.surahInfo) return;
            
            select.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø³ÙˆØ±Ø©...</option>';
            
            appState.surahInfo.forEach(surah => {
                const option = document.createElement("option");
                option.value = surah.number;
                option.textContent = `${surah.number}. ${surah.name} (${surah.englishName})`;
                select.appendChild(option);
            });
            
            // Set current surah
            select.value = appState.currentSurah;
        }

        function loadSurah() {
            const surahNumber = document.getElementById("surah-select").value;
            if (!surahNumber || !appState.quranData) return;
            
            appState.currentSurah = parseInt(surahNumber);
            loadCurrentSurah();
        }

        function loadCurrentSurah() {
            const surah = appState.quranData[appState.currentSurah];
            if (!surah) return;
            
            const mushafContent = document.getElementById("mushaf-content");
            mushafContent.innerHTML = `
                <div class="card">
                    <h3 class="card-title">Ø³ÙˆØ±Ø© ${surah.name}</h3>
                    <p class="text-muted">${surah.englishName} - ${surah.ayahs?.length || 0} Ø¢ÙŠØ©</p>
                    <div class="quran-text">
                        ï´¿ Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù ï´¾
                    </div>
                </div>
            `;
            
            // Add ayahs
            if (surah.ayahs && surah.ayahs.length > 0) {
                const ayahList = document.createElement("div");
                ayahList.className = "ayah-list-container";
                
                surah.ayahs.forEach(ayah => {
                    const ayahDiv = document.createElement("div");
                    ayahDiv.className = "ayah-item";
                    ayahDiv.onclick = () => showTafsir(appState.currentSurah, ayah.number);
                    
                    ayahDiv.innerHTML = `
                        <div class="ayah-item-number">${ayah.number}</div>
                        <div class="ayah-item-content">
                            <div class="quran-text" style="font-size: ${appState.currentFontSize}px;">
                                ${ayah.text}
                            </div>
                            <div class="ayah-item-actions">
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); bookmarkAyah(${appState.currentSurah}, ${ayah.number})">
                                    <i class="far fa-bookmark"></i>
                                </button>
                                <button class="btn btn-info" onclick="event.stopPropagation(); playAyah(${appState.currentSurah}, ${ayah.number})">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    ayahList.appendChild(ayahDiv);
                });
                
                mushafContent.appendChild(ayahList);
            }
            
            // Update navigation buttons
            updateSurahNavigation();
        }

        function prevSurah() {
            if (appState.currentSurah > 1) {
                appState.currentSurah--;
                document.getElementById("surah-select").value = appState.currentSurah;
                loadCurrentSurah();
            }
        }

        function nextSurah() {
            if (appState.currentSurah < 114) {
                appState.currentSurah++;
                document.getElementById("surah-select").value = appState.currentSurah;
                loadCurrentSurah();
            }
        }

        function updateSurahNavigation() {
            document.getElementById("prev-surah-btn").disabled = appState.currentSurah <= 1;
            document.getElementById("next-surah-btn").disabled = appState.currentSurah >= 114;
        }

        // ============================================
        // PAGES SECTION
        // ============================================

        function loadCurrentPage() {
            const pageContent = document.getElementById("page-content");
            const page = appState.pagesData[appState.currentPage];
            
            if (!page) {
                pageContent.innerHTML = '<p class="empty-state">Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø¨Ø¹Ø¯</p>';
                return;
            }
            
            pageContent.innerHTML = `
                <div class="card">
                    <h3 class="card-title">Ø§Ù„ØµÙØ­Ø© ${appState.currentPage}</h3>
                    <p class="text-muted">Ù…Ù† Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ</p>
                    <div class="quran-text">
                        Ù‡Ø°Ø§ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© ${appState.currentPage} Ù…Ù† Ø§Ù„Ù…ØµØ­Ù. ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©ØŒ Ù‡Ù†Ø§ ØªØ¸Ù‡Ø± Ø¢ÙŠØ§Øª Ø§Ù„ØµÙØ­Ø©.
                    </div>
                </div>
                
                <div class="info-grid mt-30">
                    <div class="info-item">
                        <i class="fas fa-file-alt info-icon"></i>
                        <div class="info-label">Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©</div>
                        <div class="info-value">${appState.currentPage}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-layer-group info-icon"></i>
                        <div class="info-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª</div>
                        <div class="info-value">604</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-check-circle info-icon"></i>
                        <div class="info-label">Ø§Ù„Ø­Ø§Ù„Ø©</div>
                        <div class="info-value">${appState.progress.readPages.has(appState.currentPage) ? "Ù…Ù‚Ø±ÙˆØ¡Ø©" : "ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø©"}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-percentage info-icon"></i>
                        <div class="info-label">Ø§Ù„ØªÙ‚Ø¯Ù…</div>
                        <div class="info-value">${Math.round((appState.currentPage / 604) * 100)}%</div>
                    </div>
                </div>
                
                <div class="card mt-30">
                    <h3 class="card-title"><i class="fas fa-edit"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØµÙØ­Ø©</h3>
                    <textarea id="page-notes" class="w-100 p-10 rounded" rows="3" 
                              placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©...">${appState.progress.notes[appState.currentPage] || ""}</textarea>
                    <button class="btn btn-primary mt-10" onclick="savePageNotes()">
                        <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
                    </button>
                </div>
            `;
            
            // Update page info
            updatePageInfo();
            
            // Mark as read if not already
            if (!appState.progress.readPages.has(appState.currentPage)) {
                appState.progress.readPages.add(appState.currentPage);
                updateProgressDisplay();
                saveAppState();
            }
        }

        function prevPage() {
            if (appState.currentPage > 1) {
                appState.currentPage--;
                document.getElementById("page-slider").value = appState.currentPage;
                loadCurrentPage();
            }
        }

        function nextPage() {
            if (appState.currentPage < 604) {
                appState.currentPage++;
                document.getElementById("page-slider").value = appState.currentPage;
                loadCurrentPage();
            }
        }

        function updatePageInfo() {
            document.getElementById("current-page-text").textContent = `Ø§Ù„ØµÙØ­Ø© ${appState.currentPage}`;
            document.getElementById("page-range").textContent = `Ø§Ù„ØµÙØ­Ø© ${appState.currentPage} Ù…Ù† 604`;
            
            document.getElementById("prev-page-btn").disabled = appState.currentPage <= 1;
            document.getElementById("next-page-btn").disabled = appState.currentPage >= 604;
        }

        // ============================================
        // TAFSIR SECTION
        // ============================================

        function showTafsir(surah, ayah) {
            const surahData = appState.quranData[surah];
            const ayahData = surahData?.ayahs?.find(a => a.number === ayah);
            
            if (!ayahData) return;
            
            // Switch to tafsir section
            showSection("tafsir");
            
            const tafsirContent = document.getElementById("tafsir-content");
            const tafsirText = getTafsir(surah, ayah);
            
            tafsirContent.innerHTML = `
                <div class="card">
                    <div class="quran-text">
                        ${ayahData.text}
                        <span class="ayah-number">${ayah}</span>
                    </div>
                </div>
                
                <div class="tafsir-box mt-30">
                    <div class="tafsir-title">
                        <i class="fas fa-graduation-cap"></i>
                        <h3>Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±</h3>
                    </div>
                    <p>${tafsirText || "Ø§Ù„ØªÙØ³ÙŠØ± ØºÙŠØ± Ù…ØªÙˆÙØ± Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¢ÙŠØ©."}</p>
                </div>
                
                <div class="info-grid mt-30">
                    <div class="info-item">
                        <i class="fas fa-mosque info-icon"></i>
                        <div class="info-label">Ø§Ù„Ø³ÙˆØ±Ø©</div>
                        <div class="info-value">${surahData.name}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-hashtag info-icon"></i>
                        <div class="info-label">Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ©</div>
                        <div class="info-value">${ayah}</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-info-circle info-icon"></i>
                        <div class="info-label">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</div>
                        <div class="info-value">Ø§Ù„ØªÙØ³ÙŠØ± Ù…ØªÙˆÙØ±</div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-star info-icon"></i>
                        <div class="info-label">Ø§Ù„Ù†ÙˆØ¹</div>
                        <div class="info-value">${getSurahType(surah)}</div>
                    </div>
                </div>
                
                <div class="card mt-30">
                    <h3 class="card-title"><i class="fas fa-lightbulb"></i> ØªØ£Ù…Ù„Ø§Øª</h3>
                    <p>ØªØ£Ù…Ù„ ÙÙŠ Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø¢ÙŠØ© ÙˆØ­Ø§ÙˆÙ„ ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§ ÙÙŠ Ø­ÙŠØ§ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.</p>
                </div>
            `;
            
            // Update selected ayah info
            document.getElementById("selected-ayah-info").textContent = 
                `Ø³ÙˆØ±Ø© ${surahData.name} - Ø§Ù„Ø¢ÙŠØ© ${ayah}`;
        }

        function getTafsir(surah, ayah) {
            if (!appState.tafsirData || !appState.tafsirData[surah]) return null;
            
            const surahTafsir = appState.tafsirData[surah];
            const ayahTafsir = surahTafsir.ayahs?.find(a => a.number === ayah);
            
            return ayahTafsir?.text || null;
        }

        function getSurahType(surahNumber) {
            const surah = appState.surahInfo?.find(s => s.number === surahNumber);
            return surah?.revelationType === "Meccan" ? "Ù…ÙƒÙŠØ©" : "Ù…Ø¯Ù†ÙŠØ©";
        }

        // ============================================
        // BOOKMARKS
        // ============================================

        function bookmarkAyah(surah, ayah) {
            const surahData = appState.quranData[surah];
            const ayahData = surahData?.ayahs?.find(a => a.number === ayah);
            
            if (!ayahData) return;
            
            // Check if already bookmarked
            const existingIndex = appState.progress.bookmarks.findIndex(
                b => b.surah === surah && b.ayah === ayah
            );
            
            if (existingIndex > -1) {
                // Remove bookmark
                appState.progress.bookmarks.splice(existingIndex, 1);
                showToast("ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¢ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª", "warning");
            } else {
                // Add bookmark
                appState.progress.bookmarks.push({
                    surah,
                    ayah,
                    text: ayahData.text,
                    surahName: surahData.name,
                    date: new Date().toISOString(),
                    note: ""
                });
                showToast("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¢ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª", "success");
            }
            
            saveAppState();
            
            // Reload bookmarks if on bookmarks section
            if (appState.currentSection === "bookmarks") {
                loadBookmarks();
            }
        }

        function loadBookmarks() {
            const bookmarksContent = document.getElementById("bookmarks-content");
            const bookmarksCount = document.getElementById("bookmarks-count");
            
            if (!appState.progress.bookmarks || appState.progress.bookmarks.length === 0) {
                bookmarksContent.innerHTML = '<p class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¢ÙŠØ§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø¹Ø¯</p>';
                bookmarksCount.textContent = "0 Ø¢ÙŠØ©";
                return;
            }
            
            let html = "";
            appState.progress.bookmarks.forEach((bookmark, index) => {
                html += `
                    <div class="ayah-item">
                        <div class="ayah-item-number">${bookmark.ayah}</div>
                        <div class="ayah-item-content">
                            <div class="quran-text" style="font-size: ${appState.currentFontSize}px;">
                                ${bookmark.text}
                            </div>
                            <div class="d-flex justify-between mt-10">
                                <span class="text-muted">${bookmark.surahName}</span>
                                <span class="text-muted">${new Date(bookmark.date).toLocaleDateString("ar-SA")}</span>
                            </div>
                            <div class="ayah-item-actions">
                                <button class="btn btn-secondary" onclick="showTafsir(${bookmark.surah}, ${bookmark.ayah})">
                                    <i class="fas fa-book-open"></i> ØªÙØ³ÙŠØ±
                                </button>
                                <button class="btn btn-danger" onclick="removeBookmark(${index})">
                                    <i class="fas fa-trash"></i> Ø­Ø°Ù
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            bookmarksContent.innerHTML = html;
            bookmarksCount.textContent = `${appState.progress.bookmarks.length} Ø¢ÙŠØ©`;
        }

        function removeBookmark(index) {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ù‡Ø°Ù‡ Ø§Ù„Ø¢ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§ØªØŸ")) {
                appState.progress.bookmarks.splice(index, 1);
                saveAppState();
                loadBookmarks();
                showToast("ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¢ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª", "warning");
            }
        }

        function clearAllBookmarks() {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.")) {
                appState.progress.bookmarks = [];
                saveAppState();
                loadBookmarks();
                showToast("ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª", "danger");
            }
        }

        // ============================================
        // PROGRESS & STATISTICS
        // ============================================

        function updateProgressDisplay() {
            const totalAyahs = 6236; // Total ayahs in Quran
            const totalPages = 604;
            
            const readAyahs = appState.progress.readAyahs;
            const readPages = appState.progress.readPages.size;
            
            const ayahProgress = Math.min(100, (readAyahs / totalAyahs) * 100);
            const pageProgress = Math.min(100, (readPages / totalPages) * 100);
            const totalProgress = (ayahProgress + pageProgress) / 2;
            
            // Update progress bar
            document.getElementById("progress-fill").style.width = `${totalProgress}%`;
            document.getElementById("progress-text").innerHTML = 
                `Ø§Ù„ØªÙ‚Ø¯Ù…: <strong>${Math.round(totalProgress)}%</strong>`;
            
            // Update stats
            const readingTime = Math.floor(appState.progress.readingTime / 60); // Convert to hours
            document.getElementById("stats-text").textContent = 
                `ğŸ“– ${readAyahs} Ø¢ÙŠØ© | â±ï¸ ${readingTime} Ø³Ø§Ø¹Ø©`;
        }

        function updateStats() {
            const totalAyahs = 6236;
            const totalPages = 604;
            
            const readAyahs = appState.progress.readAyahs;
            const readPages = appState.progress.readPages.size;
            
            document.getElementById("stats-streak").textContent = `${appState.progress.streak} ÙŠÙˆÙ…`;
            document.getElementById("stats-ayahs").textContent = `${readAyahs} Ø¢ÙŠØ©`;
            document.getElementById("stats-time").textContent = `${appState.progress.readingTime} Ø¯Ù‚ÙŠÙ‚Ø©`;
            document.getElementById("stats-completion").textContent = 
                `${Math.round((readAyahs / totalAyahs) * 100)}%`;
        }

        function markAyahAsRead(surah, ayah) {
            appState.progress.readAyahs++;
            appState.progress.readingTime += 1; // 1 minute per ayah
            
            // Update streak
            const today = new Date().toDateString();
            const lastRead = appState.progress.lastRead ? new Date(appState.progress.lastRead).toDateString() : null;
            
            if (lastRead === today) {
                // Already read today
            } else if (lastRead && isYesterday(lastRead)) {
                appState.progress.streak++;
            } else {
                appState.progress.streak = 1;
            }
            
            appState.progress.lastRead = new Date().toISOString();
            
            // Update UI
            updateProgressDisplay();
            updateStats();
            saveAppState();
            
            showToast("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¢ÙŠØ©", "success");
        }

        function isYesterday(dateString) {
            const date = new Date(dateString);
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            return date.toDateString() === yesterday.toDateString();
        }

        // ============================================
        // REMINDERS
        // ============================================

        function saveReminder() {
            const time = document.getElementById("reminder-time-input").value;
            appState.settings.reminderTime = time;
            
            // Save to state
            appState.reminders.push({
                time,
                enabled: true,
                lastTriggered: null,
                days: [0, 1, 2, 3, 4, 5, 6] // All days
            });
            
            saveAppState();
            scheduleReminders();
            
            showToast(`ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ°ÙƒÙŠØ± Ù„Ù„Ø³Ø§Ø¹Ø© ${time}`, "success");
        }

        function scheduleReminders() {
            if (!appState.settings.notifications) return;
            
            const [hours, minutes] = appState.settings.reminderTime.split(":").map(Number);
            const now = new Date();
            const reminderTime = new Date();
            
            reminderTime.setHours(hours, minutes, 0, 0);
            
            // If time has passed today, schedule for tomorrow
            if (reminderTime <= now) {
                reminderTime.setDate(reminderTime.getDate() + 1);
            }
            
            const timeUntilReminder = reminderTime.getTime() - now.getTime();
            
            setTimeout(() => {
                if (Notification.permission === "granted") {
                    showNotification("ğŸ•Œ ÙˆÙ‚Øª Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†", "Ø­Ø§Ù† ÙˆÙ‚Øª Ù‚Ø±Ø§Ø¡Ø© ÙˆØ±Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…");
                }
                // Reschedule for next day
                scheduleReminders();
            }, timeUntilReminder);
        }

        function enableNotifications() {
            if (!("Notification" in window)) {
                showToast("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª", "danger");
                return;
            }
            
            if (Notification.permission === "granted") {
                appState.settings.notifications = true;
                saveAppState();
                document.getElementById("notification-permission-box").classList.add("hidden");
                showToast("Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…ÙØ¹Ù„Ø© Ø¨Ø§Ù„ÙØ¹Ù„", "success");
                return;
            }
            
            if (Notification.permission === "denied") {
                showToast("ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„Ù‡Ø§ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­.", "danger");
                return;
            }
            
            Notification.requestPermission().then(permission => {
                if (permission === "granted") {
                    appState.settings.notifications = true;
                    saveAppState();
                    document.getElementById("notification-permission-box").classList.add("hidden");
                    showToast("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", "success");
                    scheduleReminders();
                } else {
                    showToast("Ù„Ù… ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª", "warning");
                }
            });
        }

        function testNotification() {
            if (Notification.permission === "granted") {
                showNotification("ğŸ”” ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªØ°ÙƒÙŠØ±", "Ù‡Ø°Ø§ ØªØ°ÙƒÙŠØ± ØªØ¬Ø±ÙŠØ¨ÙŠ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ù…ØµØ­Ù Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…");
                showToast("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ", "success");
            } else {
                enableNotifications();
            }
        }

        function showNotification(title, body) {
            if (Notification.permission === "granted") {
                new Notification(title, {
                    body,
                    icon: "https://img.icons8.com/color/96/000000/quran.png",
                    badge: "https://img.icons8.com/color/96/000000/quran.png"
                });
            }
        }

        // ============================================
        // SETTINGS FUNCTIONS
        // ============================================

        function applySettings() {
            // Apply theme
            applyTheme();
            
            // Apply font
            applyFont();
            
            // Apply other settings
            document.getElementById("auto-save-toggle").checked = appState.settings.autoSave;
            document.getElementById("auto-scroll-toggle").checked = appState.settings.autoScroll;
            document.getElementById("show-tafsir-toggle").checked = appState.settings.showTafsir;
            document.getElementById("dark-mode-toggle").checked = appState.settings.theme === "dark";
            document.getElementById("font-size-slider").value = appState.settings.fontSize;
            document.getElementById("font-size-value").textContent = `${appState.settings.fontSize}px`;
            document.getElementById("reminder-time-input").value = appState.settings.reminderTime;
            
            // Apply font selector
            document.querySelectorAll(".font-option").forEach(option => {
                option.classList.remove("active");
            });
            document.querySelector(`.font-option.${appState.settings.fontFamily}`)?.classList.add("active");
        }

        function applyTheme() {
            const isDark = appState.settings.theme === "dark";
            document.documentElement.setAttribute("data-theme", isDark ? "dark" : "light");
            
            // Update theme color
            document.querySelector('meta[name="theme-color"]').setAttribute("content", appState.settings.themeColor);
        }

        function applyFont() {
            document.querySelectorAll(".quran-text").forEach(element => {
                element.style.fontFamily = appState.settings.fontFamily === "amiri" 
                    ? "'Amiri Quran', serif" 
                    : appState.settings.fontFamily === "uthmani"
                    ? "'Traditional Arabic', serif"
                    : "'Noto Naskh Arabic', serif";
                
                element.style.fontSize = `${appState.settings.fontSize}px`;
            });
        }

        function changeThemeColor(color) {
            appState.settings.themeColor = color;
            applyTheme();
            saveAppState();
            showToast("ØªÙ… ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø³Ù…Ø©", "success");
        }

        function changeFont(font) {
            appState.settings.fontFamily = font;
            applyFont();
            saveAppState();
            
            // Update font selector
            document.querySelectorAll(".font-option").forEach(option => {
                option.classList.remove("active");
            });
            event.target.classList.add("active");
            
            showToast(`ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø®Ø· Ø¥Ù„Ù‰ ${font}`, "success");
        }

        function changeFontSize(size) {
            appState.settings.fontSize = parseInt(size);
            document.getElementById("font-size-value").textContent = `${size}px`;
            applyFont();
            saveAppState();
        }

        // ============================================
        // DATA MANAGEMENT
        // ============================================

        function exportData() {
            const data = {
                appState: {
                    ...appState,
                    progress: {
                        ...appState.progress,
                        readPages: Array.from(appState.progress.readPages),
                        completedSurahs: Array.from(appState.progress.completedSurahs)
                    }
                },
                exportDate: new Date().toISOString(),
                version: APP_CONFIG.version
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = "data:application/json;charset=utf-8," + encodeURIComponent(dataStr);
            
            const link = document.createElement("a");
            link.setAttribute("href", dataUri);
            link.setAttribute("download", `quran-backup-${new Date().toISOString().slice(0,10)}.json`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast("ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", "success");
        }

        function importData() {
            const input = document.createElement("input");
            input.type = "file";
            input.accept = ".json";
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        
                        if (!importedData.appState || !importedData.version) {
                            throw new Error("Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­");
                        }
                        
                        if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©.")) {
                            // Restore app state
                            const importedState = importedData.appState;
                            
                            appState = {
                                ...appState,
                                ...importedState,
                                progress: {
                                    ...appState.progress,
                                    ...importedState.progress,
                                    readPages: new Set(importedState.progress?.readPages || []),
                                    completedSurahs: new Set(importedState.progress?.completedSurahs || []),
                                    bookmarks: importedState.progress?.bookmarks || []
                                }
                            };
                            
                            // Save and reload
                            saveAppState();
                            location.reload();
                            
                            showToast("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", "success");
                        }
                    } catch (error) {
                        showToast("Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­", "danger");
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function backupData() {
            saveAppState();
            appState.lastBackup = new Date().toISOString();
            showToast("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©", "success");
        }

        // ============================================
        // RESET FUNCTIONS
        // ============================================

        function resetProgressOnly() {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙ‚Ø·ØŸ")) {
                appState.progress = {
                    readAyahs: 0,
                    readPages: new Set(),
                    readingTime: 0,
                    streak: 0,
                    lastRead: null,
                    dailyProgress: {},
                    bookmarks: appState.progress.bookmarks, // Keep bookmarks
                    notes: {},
                    completedSurahs: new Set()
                };
                
                saveAppState();
                updateProgressDisplay();
                updateStats();
                
                showToast("ØªÙ… ØªØµÙÙŠØ± Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª", "success");
            }
        }

        function resetBookmarksOnly() {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§ØªØŸ")) {
                appState.progress.bookmarks = [];
                saveAppState();
                loadBookmarks();
                showToast("ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª", "success");
            }
        }

        function resetSettingsOnly() {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ")) {
                appState.settings = {
                    theme: "light",
                    themeColor: "#1a472a",
                    autoSave: true,
                    autoScroll: true,
                    showTafsir: true,
                    reminderTime: "05:00",
                    notifications: false,
                    fontSize: 28,
                    fontFamily: "amiri"
                };
                
                saveAppState();
                applySettings();
                showToast("ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", "success");
            }
        }

        function resetEverything() {
            if (confirm("âš ï¸  ØªØ­Ø°ÙŠØ± Ø´Ø¯ÙŠØ¯!\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù:\nâ€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØªÙ‚Ø¯Ù…\nâ€¢ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª\nâ€¢ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª\nâ€¢ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª\n\nâŒ Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡Ø§!")) {
                // Clear all data
                localStorage.clear();
                
                // Reload app
                location.reload();
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        function showLoading(message) {
            // You can implement a loading spinner here
            console.log("â³ " + message);
        }

        function hideLoading() {
            // Hide loading spinner
            console.log("âœ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªÙ…Ù„");
        }

        function showError(message) {
            alert("âŒ " + message);
        }

        function showToast(message, type = "info") {
            // Create toast element
            const toast = document.createElement("div");
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === "success" ? "#28a745" : type === "warning" ? "#ffc107" : type === "danger" ? "#dc3545" : "#17a2b8"};
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.style.animation = "slideOut 0.3s ease";
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        function updateDate() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateStr = today.toLocaleDateString('ar-SA', options);
            document.getElementById("today-date").textContent = dateStr;
        }

        function checkConnectivity() {
            const indicator = document.getElementById("offline-indicator");
            
            function updateStatus() {
                if (navigator.onLine) {
                    indicator.style.display = "none";
                } else {
                    indicator.style.display = "flex";
                }
            }
            
            window.addEventListener("online", updateStatus);
            window.addEventListener("offline", updateStatus);
            
            updateStatus();
        }

        function setupEventListeners() {
            // Page slider
            document.getElementById("page-slider").addEventListener("input", function() {
                appState.currentPage = parseInt(this.value);
                loadCurrentPage();
            });
            
            // Settings toggles
            document.getElementById("dark-mode-toggle").addEventListener("change", function() {
                appState.settings.theme = this.checked ? "dark" : "light";
                applyTheme();
                saveAppState();
            });
            
            document.getElementById("auto-save-toggle").addEventListener("change", function() {
                appState.settings.autoSave = this.checked;
                saveAppState();
            });
            
            document.getElementById("auto-scroll-toggle").addEventListener("change", function() {
                appState.settings.autoScroll = this.checked;
                saveAppState();
            });
            
            document.getElementById("show-tafsir-toggle").addEventListener("change", function() {
                appState.settings.showTafsir = this.checked;
                saveAppState();
            });
            
            // Font size slider
            document.getElementById("font-size-slider").addEventListener("input", function() {
                changeFontSize(this.value);
            });
            
            // Install button
            document.getElementById("install-btn").addEventListener("click", installApp);
        }

        function installApp() {
            if (navigator.standalone) {
                showToast("Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨Øª Ø¨Ø§Ù„ÙØ¹Ù„ Ø¹Ù„Ù‰ Ø´Ø§Ø´ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©!", "success");
                return;
            }
            
            showToast("Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© â†’ Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", "info");
        }

        function checkForUpdates() {
            showToast("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª...", "info");
            setTimeout(() => {
                showToast("Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ø¯Ø« Ø¨Ø£Ø­Ø¯Ø« Ù†Ø³Ø®Ø©", "success");
            }, 1000);
        }

        function savePageNotes() {
            const notes = document.getElementById("page-notes").value;
            appState.progress.notes[appState.currentPage] = notes;
            saveAppState();
            showToast("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª", "success");
        }

        // ============================================
        // SAMPLE DATA (FALLBACK)
        // ============================================

        function getSampleQuranData() {
            return {
                "1": {
                    "name": "Ø§Ù„ÙØ§ØªØ­Ø©",
                    "ayahs": [
                        {"number": 1, "text": "Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù"},
                        {"number": 2, "text": "Ù±Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ù±Ù„Ù’Ø¹ÙÙ°Ù„ÙÙ…ÙÙŠÙ†Ù"},
                        {"number": 3, "text": "Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù"},
                        {"number": 4, "text": "Ù…ÙÙ°Ù„ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù Ù±Ù„Ø¯ÙÙ‘ÙŠÙ†Ù"},
                        {"number": 5, "text": "Ø¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ³Ù’ØªÙØ¹ÙÙŠÙ†Ù"},
                        {"number": 6, "text": "Ù±Ù‡Ù’Ø¯ÙÙ†ÙØ§ Ù±Ù„ØµÙÙ‘Ø±ÙÙ°Ø·Ù Ù±Ù„Ù’Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…Ù"},
                        {"number": 7, "text": "ØµÙØ±ÙÙ°Ø·Ù Ù±Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø£ÙÙ†Ù’Ø¹ÙÙ…Ù’ØªÙ Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ØºÙÙŠÙ’Ø±Ù Ù±Ù„Ù’Ù…ÙØºØ¶ÙÙˆØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ Ù±Ù„Ø¶ÙÙ‘Ø¢Ù„ÙÙ‘ÙŠÙ†Ù"}
                    ]
                },
                "2": {
                    "name": "Ø§Ù„Ø¨Ù‚Ø±Ø©",
                    "ayahs": [
                        {"number": 1, "text": "Ø§Ù„Ù“Ù…Ù“"},
                        {"number": 2, "text": "Ø°ÙÙ°Ù„ÙÙƒÙ Ù±Ù„Ù’ÙƒÙØªÙÙ°Ø¨Ù Ù„ÙØ§ Ø±ÙÙŠÙ’Ø¨Ù Û› ÙÙÙŠÙ‡Ù Û› Ù‡ÙØ¯Ù‹Ù‰ Ù„ÙÙ‘Ù„Ù’Ù…ÙØªÙÙ‘Ù‚ÙÙŠÙ†Ù"},
                        {"number": 3, "text": "Ù±Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù ÙŠÙØ¤Ù’Ù…ÙÙ†ÙÙˆÙ†Ù Ø¨ÙÙ±Ù„Ù’ØºÙÙŠÙ’Ø¨Ù ÙˆÙÙŠÙÙ‚ÙÙŠÙ…ÙÙˆÙ†Ù Ù±Ù„ØµÙÙ‘Ù„ÙÙˆÙ°Ø©Ù ÙˆÙÙ…ÙÙ…ÙÙ‘Ø§ Ø±ÙØ²ÙÙ‚Ù’Ù†ÙÙ°Ù‡ÙÙ…Ù’ ÙŠÙÙ†ÙÙÙ‚ÙÙˆÙ†Ù"}
                    ]
                }
            };
        }

        // ============================================
        // INITIALIZE APP
        // ============================================

        // Register Service Worker
        if ("serviceWorker" in navigator) {
            window.addEventListener("load", () => {
                navigator.serviceWorker.register("sw.js")
                    .then(registration => {
                        console.log("âœ… Service Worker Ù…Ø³Ø¬Ù„:", registration.scope);
                    })
                    .catch(error => {
                        console.log("âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Service Worker:", error);
                    });
            });
        }

        // Start the app
        window.addEventListener("DOMContentLoaded", initializeApp);

        // Auto-save before unload
        window.addEventListener("beforeunload", saveAppState);
    </script>
</body>
</html>
